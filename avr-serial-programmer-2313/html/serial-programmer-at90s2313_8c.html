<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AVR Serial Programmer: serial-programmer-at90s2313.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>serial-programmer-at90s2313.c File Reference</h1><code>#include &lt;inttypes.h&gt;</code><br/>
<code>#include &lt;avr/eeprom.h&gt;</code><br/>
<code>#include &lt;avr/sfr_defs.h&gt;</code><br/>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/wdt.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="defines_8h_source.html">defines.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="serial-programmer-at90s2313_8h_source.html">serial-programmer-at90s2313.h</a>&quot;</code><br/>
<code>#include &lt;util/delay.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="serial_8h_source.html">serial.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for serial-programmer-at90s2313.c:</div>
<div class="dynsection">
<div class="center"><img src="serial-programmer-at90s2313_8c__incl.png" border="0" usemap="#serial-programmer-at90s2313_8c_map" alt=""/></div>
<map name="serial-programmer-at90s2313_8c_map" id="serial-programmer-at90s2313_8c">
<area shape="rect" href="defines_8h.html" title="defines.h" alt="" coords="539,83,613,112"/><area shape="rect" href="serial-programmer-at90s2313_8h.html" title="serial&#45;programmer&#45;at90s2313.h" alt="" coords="637,83,835,112"/><area shape="rect" href="serial_8h.html" title="serial.h" alt="" coords="965,83,1029,112"/></map>
</div>

<p><a href="serial-programmer-at90s2313_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a11643f271076024c395a93800b3d9546">_BV</a>(bit)&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a5f2f31448ae0df9a545e0ca95e748f16">inb</a>(sfr)&nbsp;&nbsp;&nbsp;_SFR_BYTE(sfr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ab5e5eb4fcc7a892227a005faab343610">inw</a>(sfr)&nbsp;&nbsp;&nbsp;_SFR_WORD(sfr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ab2639428f628a54f52f28ace148beb13">outb</a>(sfr, val)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) = (val))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aaf663ae912dca7197d8ffab94ecbfb6d">outw</a>(sfr, val)&nbsp;&nbsp;&nbsp;(_SFR_WORD(sfr) = (val))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ae70baf5399951da1e7ad45a0ed890832">cbi</a>(sfr, bit)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) &amp;= ~_BV(bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ac4a5536d9bf092116f88b94797ddc882">sbi</a>(sfr, bit)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) |= _BV(bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a292660d4f9b4776e3ae19a977c2c9d51">high</a>(x)&nbsp;&nbsp;&nbsp;((uint8_t) (x &gt;&gt; 8) &amp; 0xFF)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ae7272abbc457b8a5fd4de78326f216a3">low</a>(x)&nbsp;&nbsp;&nbsp;((uint8_t) (x &amp; 0xFF))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a3d6b4ec100d3ded8506abe9af8757eb9">NUMPARTS</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Array of parts and properties.  <a href="#a3d6b4ec100d3ded8506abe9af8757eb9"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aa4f00419077779c9de129f2f9bd1f3bf">BlockLoad</a> (uint16_t size, unsigned char mem, uint16_t *<a class="el" href="serial-programmer-at90s2313_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a block to application memory.  <a href="#aa4f00419077779c9de129f2f9bd1f3bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a02d90b2a73df346dcd7f5996ec0c7391">BlockRead</a> (unsigned int size, unsigned char mem, uint16_t *<a class="el" href="serial-programmer-at90s2313_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a block from application memory.  <a href="#a02d90b2a73df346dcd7f5996ec0c7391"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ad8a9ca95bd263ee8a63640e95bafd0ec">writeByte</a> (const uint8_t datum)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a Byte to the SPI.  <a href="#ad8a9ca95bd263ee8a63640e95bafd0ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a378eeebde3e3245f5eed58b91f2ccef8">writeCommand</a> (const uint8_t cmd, const uint8_t parm1, const uint8_t parm2, const uint8_t parm3)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a four byte Programming command to the SPI.  <a href="#a378eeebde3e3245f5eed58b91f2ccef8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aecc1e1a2f637e90d4b74efa6e73e6d2c">pollDelay</a> (const uint8_t shortDelay)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delay loop for writes.  <a href="#aecc1e1a2f637e90d4b74efa6e73e6d2c"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a0e37664306c255e1c9e97bcfcd3227ee">part</a> [NUMPARTS][6]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#af48e0311746bc01574a90f142220e748">command</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a937c9ea30a584c36e788de708fd56234">tempInt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a2d4df151e5b0c94e87c699dac29bed44">lsbAddress</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a58ca3b9b83727957c5e3d2395dd6db31">msbAddress</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a59bb6204e17a27f285f9b7cedac9367d">buffer</a> [4]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#abbcb8b2461229b0e3c3d12b484830a60">fPageSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a1ac1748ccf339b8a6b672d1cf6bd8254">ePageSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#aebf7b0a2734d6f569a454d4d1ce183d5">canCheckBusy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#a0e041ba43d06e19f13362db84cb2eac9">lfCapability</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-at90s2313_8c.html#ac7c4860b47674f6bb351f6875e50533f">received</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a11643f271076024c395a93800b3d9546"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::_BV" ref="a11643f271076024c395a93800b3d9546" args="(bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _BV</td>
          <td>(</td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00088">88</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

</div>
</div>
<a class="anchor" id="ae70baf5399951da1e7ad45a0ed890832"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::cbi" ref="ae70baf5399951da1e7ad45a0ed890832" args="(sfr, bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cbi</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) &amp;= ~_BV(bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00093">93</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

</div>
</div>
<a class="anchor" id="aa93f0eb578d23995850d61f7d61c55c1"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::FALSE" ref="aa93f0eb578d23995850d61f7d61c55c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FALSE&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00086">86</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a292660d4f9b4776e3ae19a977c2c9d51"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::high" ref="a292660d4f9b4776e3ae19a977c2c9d51" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define high</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((uint8_t) (x &gt;&gt; 8) &amp; 0xFF)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00095">95</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a5f2f31448ae0df9a545e0ca95e748f16"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::inb" ref="a5f2f31448ae0df9a545e0ca95e748f16" args="(sfr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define inb</td>
          <td>(</td>
          <td class="paramtype">sfr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;_SFR_BYTE(sfr)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00089">89</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

</div>
</div>
<a class="anchor" id="ab5e5eb4fcc7a892227a005faab343610"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::inw" ref="ab5e5eb4fcc7a892227a005faab343610" args="(sfr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define inw</td>
          <td>(</td>
          <td class="paramtype">sfr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;_SFR_WORD(sfr)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00090">90</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae7272abbc457b8a5fd4de78326f216a3"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::low" ref="ae7272abbc457b8a5fd4de78326f216a3" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define low</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((uint8_t) (x &amp; 0xFF))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00096">96</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a3d6b4ec100d3ded8506abe9af8757eb9"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::NUMPARTS" ref="a3d6b4ec100d3ded8506abe9af8757eb9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUMPARTS&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Array of parts and properties. </p>
<p>This lists all the target devices supported by the programmer.</p>
<p>The first signature byte is assumed to be always E1. If not, then we abort programming. Flash and EEPROM page sizes zero means that page writes are not supported. Lock and Fuse support is given by a bitwise quantity. 0 = Lock Read 1 = Fuse Read 2 = High Fuse Read 3 = Extended Fuse Read 4 = Lock Write 5 = Fuse Write 6 = High Fuse Write 7 = Extended Fuse Write </p>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00117">117</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2639428f628a54f52f28ace148beb13"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::outb" ref="ab2639428f628a54f52f28ace148beb13" args="(sfr, val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define outb</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) = (val))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00091">91</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

</div>
</div>
<a class="anchor" id="aaf663ae912dca7197d8ffab94ecbfb6d"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::outw" ref="aaf663ae912dca7197d8ffab94ecbfb6d" args="(sfr, val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define outw</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_WORD(sfr) = (val))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00092">92</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac4a5536d9bf092116f88b94797ddc882"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::sbi" ref="ac4a5536d9bf092116f88b94797ddc882" args="(sfr, bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define sbi</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) |= _BV(bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00094">94</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8cecfc5c5c054d2875c03e77b7be15d"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::TRUE" ref="aa8cecfc5c5c054d2875c03e77b7be15d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRUE&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00085">85</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa4f00419077779c9de129f2f9bd1f3bf"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::BlockLoad" ref="aa4f00419077779c9de129f2f9bd1f3bf" args="(uint16_t size, unsigned char mem, uint16_t *address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char BlockLoad </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&nbsp;</td>
          <td class="paramname"> <em>address</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a block to application memory. </p>
<p>Block Load can be used to reduce the traffic on the serial link.</p>
<p>The block is read in and is written page by page to the AVR internal page buffer, each page followed by a page write. The program allows for blocksizes larger than the target page buffer. The EEPROM internal buffer is typically only 4 bytes, while the FLASH buffer can be from 16 to 64 words.</p>
<p>Take care that EEPROM addresses are given in bytes, while FLASH addresses are in words.</p>
<p>The code is a bit involved when dealing with non-paged support. We do not use pages at all so pageSize is irrelevant and ends up being -1, which in unsigned arithmetic should be all 1's. However it is used to set the addresses in both paged and non- paged modes, so we may see some side-effects here. It should be worked a bit better but space is running out. In the devices, pages are always used when the memory is above a certain size, so 8-bit addressing should be OK.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>size,:</em>&nbsp;</td><td>Size of the transfer in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mem,:</em>&nbsp;</td><td>Memory type ('E' or 'F') </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*address,:</em>&nbsp;</td><td>pointer to the memory address in bytes (EEPROM) or words (FLASH) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>response ('?' or '\r') to return to the PC </dd></dl>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">536</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00138">ePageSize</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00086">FALSE</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00137">fPageSize</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00095">high</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00096">low</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00134">lsbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">pollDelay()</a>, <a class="el" href="serial_8c_source.html#l00038">recchar()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00085">TRUE</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a02d90b2a73df346dcd7f5996ec0c7391"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::BlockRead" ref="a02d90b2a73df346dcd7f5996ec0c7391" args="(unsigned int size, unsigned char mem, uint16_t *address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BlockRead </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&nbsp;</td>
          <td class="paramname"> <em>address</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a block from application memory. </p>
<p>There is no block read as such in the SPI interface, just do it byte by byte. This code allows the interface to reduce traffic by reading in a single transaction.</p>
<p>Take care that EEPROM addresses are given in bytes, while FLASH addresses are in words.</p>
<p>Note that the low byte is returned first, followed by the high byte. This differs from the 'R' command in which the high byte is returned first.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>size,:</em>&nbsp;</td><td>Size of the buffer in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mem,:</em>&nbsp;</td><td>Memory type ('E' or 'F') </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*address,:</em>&nbsp;</td><td>pointer to the memory address in bytes (EEPROM) or words (FLASH) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">611</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00136">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00095">high</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00096">low</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00134">lsbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00135">msbAddress</a>, <a class="el" href="serial_8c_source.html#l00030">sendchar()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::main" ref="a840291bc02cba5474a4cb46a9b9566fe" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>Set PORTB as outputs on bits 7,5,4 to set controls, and set high, MISO input on bit 5. Set the Ports PB0-2 as outputs and set high to turn off all LEDs PB0 = programmed LED PB1 = Programming mode LED</p>
<p>'a' Check autoincrement status. This allows a block of data to be uploaded to consecutive addresses without specifying the address each time</p>
<p>'A' Set address. This is stored and incremented for each upload/download. NOTE: Flash addresses are given as word addresses, not byte addresses.</p>
<p>'b' Check block load support. This returns the allowed block size. We will not buffer anything so we will use the FLASH page size to limit the programmer's blocks to those that will fit the target's page. This then avoids the long delay when the page is committed, that may cause incoming data to be lost. This should not be called before the P command is executed, and the target device characteristics obtained. The fPageSize characteristic should be non zero.</p>
<p>'p' Get programmer type. This returns just 'S' for serial.</p>
<p>'S' Return programmer identifier. Always 7 digits. We call it AVRSPRG</p>
<p>'V' Return software version.</p>
<p>'t' Return supported device codes. This returns a list of devices that can be programmed. This is only used by AVRPROG so we will not use it, and will work with signature bytes instead.</p>
<p>'x' Set LED.</p>
<p>'y' clear LED.</p>
<p>'T' select device type</p>
<p>'P' Enter programming mode. This starts the programming of the device. Pulse the reset line high while SCK is low. Send the command and ensure that the echoed second byte is correct, otherwise redo. With this we get the device signature and search the table for its characteristics. A timeout is provided in case the device doesn't respond. This will allow fall through to an ultimate error response.</p>
<p>Once we are in programming mode, grab the signature bytes and extract all information about the target device such as its memory sizes, page sizes and capabilities.</p>
<p>'L' Leave programming mode.</p>
<p>'e' Chip erase. This requires several ms. Ensure that the command has finished before acknowledging.</p>
<p>'R' Read program memory</p>
<p>Send high byte, then low byte of flash word. Send each byte from the address specified (note address variable is modified).</p>
<p>'c' Write to program memory page buffer, low byte. NOTE: Always use this command before sending the high byte. It is written to the page but the address is not incremented.</p>
<p>'C' Write to program memory page buffer, high byte. This will cause the word to be written to the page and the address incremented. It is the responsibility of the user to issue a page write command.</p>
<p>'m' Issue Page Write. This writes the target device page buffer to the Flash. The address is that of the page, with the lower bits masked out. This requires several ms. Ensure that the command has finished before acknowledging. We could check for end of memory here but that would require storing the Flash capacity for each device. The calling program will know in any case if it has overstepped.</p>
<p>'D' Write EEPROM memory This writes the byte directly to the EEPROM at the specified address. This requires several ms. Ensure that the command has finished before acknowledging.</p>
<p>'d' Read EEPROM memory</p>
<p>'B' Start block load. The address must have already been set otherwise it will be undefined.</p>
<p>'g' Start block read. The address must have already been set otherwise it will be undefined.</p>
<p>'r' Read lock bits.</p>
<p>'l' Write lockbits.</p>
<p>'F' Read fuse bits.</p>
<p>'f' Write fuse bits.</p>
<p>'N' Read high fuse bits.</p>
<p>'n' Write high fuse bits.</p>
<p>'Q' Read extended fuse bits.</p>
<p>'q' Write extended fuse bits.</p>
<p>'s' Return signature bytes. Sent Most Significant Byte first.</p>
<p>'E' Exit bootloader. At this command we enter serial passthrough and don't return from it until a hardware reset occurs. At the same time we should lift the reset from the target. Spin endlessly so we don't interpret serial data, and wait for our own hard reset.</p>
<p>The last command to accept is ESC (synchronization). This is used to abort any command by filling in remaining parameters, after which it is simply ignored. Otherwise, the command is not recognized and a "?" is returned. </p>
</p>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">143</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">address</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00136">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00139">canCheckBusy</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00093">cbi</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00132">command</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00138">ePageSize</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00086">FALSE</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00137">fPageSize</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00095">high</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00089">inb</a>, <a class="el" href="serial_8c_source.html#l00022">initbootuart()</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00032">LED</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00140">lfCapability</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00096">low</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00134">lsbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00135">msbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00117">NUMPARTS</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00091">outb</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00118">part</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00030">PASSTHROUGH</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">pollDelay()</a>, <a class="el" href="serial_8c_source.html#l00038">recchar()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00141">received</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00029">RESET</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00094">sbi</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00026">SCK</a>, <a class="el" href="serial_8c_source.html#l00030">sendchar()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00133">tempInt</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00085">TRUE</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="aecc1e1a2f637e90d4b74efa6e73e6d2c"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::pollDelay" ref="aecc1e1a2f637e90d4b74efa6e73e6d2c" args="(const uint8_t shortDelay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pollDelay </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>shortDelay</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delay loop for writes. </p>
<p>The target capability for polling the busy status is used to determine if this is to be used or if a fixed delay is needed. The delay is passed in the parameter.</p>
<p>The compiler has a problem with passing a parameter to _delay_ms, and memory usage bloats. So we need some fixed delays. Most likely _delay_us is too general and includes floats.</p>
<p>Note the datasheet labels the flag as RDY, when in fact it states later that it is the inverse, BSY, that is, wait until the flag drops to 0 before proceeding.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>shortDelay</em>&nbsp;</td><td>Is the delay short?: TRUE for FLASH (4.5ms) or FALSE for erase, EEPROM (9ms). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">699</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00136">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00139">canCheckBusy</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ad8a9ca95bd263ee8a63640e95bafd0ec"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::writeByte" ref="ad8a9ca95bd263ee8a63640e95bafd0ec" args="(const uint8_t datum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t writeByte </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>datum</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a Byte to the SPI. </p>
<p>Issue a write of a single byte on the SPI interface Note that the data is transmitted and received MSB first. Also note that the device is acting as a Master for the SPI bus,so MOSI is output and MISO is input.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>datum,:</em>&nbsp;</td><td>the byte to be written </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>response: a byte read at the same time as the byte was written. </dd></dl>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">644</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00088">_BV</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00093">cbi</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00089">inb</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00027">MISO</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00028">MOSI</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00091">outb</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00094">sbi</a>, and <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00026">SCK</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="a378eeebde3e3245f5eed58b91f2ccef8"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::writeCommand" ref="a378eeebde3e3245f5eed58b91f2ccef8" args="(const uint8_t cmd, const uint8_t parm1, const uint8_t parm2, const uint8_t parm3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeCommand </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm3</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a four byte Programming command to the SPI. </p>
<p>Issue a write command on the SPI interface This returns responses which (usually) match the command, one byte delayed. The third byte read from the "start programming" command can be used to verify sync. Other read commands return the read value in the fourth byte.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cmd</em>&nbsp;</td><td>SPI Programming command </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parm1</em>&nbsp;</td><td>SPI Programming parameter 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parm2</em>&nbsp;</td><td>SPI Programming parameter 2 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parm3</em>&nbsp;</td><td>SPI Programming parameter 3 </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The global buffer four bytes with the data returned from the command </dd></dl>

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">677</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00136">buffer</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00644">writeByte()</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">pollDelay()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a643d30df67a67c5915fde941c934f9f8"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::address" ref="a643d30df67a67c5915fde941c934f9f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="serial-programmer-at90s2313_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">131</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a59bb6204e17a27f285f9b7cedac9367d"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::buffer" ref="a59bb6204e17a27f285f9b7cedac9367d" args="[4]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a59bb6204e17a27f285f9b7cedac9367d">buffer</a>[4]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00136">136</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">pollDelay()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00677">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="aebf7b0a2734d6f569a454d4d1ce183d5"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::canCheckBusy" ref="aebf7b0a2734d6f569a454d4d1ce183d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#aebf7b0a2734d6f569a454d4d1ce183d5">canCheckBusy</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00139">139</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00699">pollDelay()</a>.</p>

</div>
</div>
<a class="anchor" id="af48e0311746bc01574a90f142220e748"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::command" ref="af48e0311746bc01574a90f142220e748" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="serial-programmer-at90s2313_8c.html#af48e0311746bc01574a90f142220e748">command</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00132">132</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ac1748ccf339b8a6b672d1cf6bd8254"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::ePageSize" ref="a1ac1748ccf339b8a6b672d1cf6bd8254" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a1ac1748ccf339b8a6b672d1cf6bd8254">ePageSize</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00138">138</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="abbcb8b2461229b0e3c3d12b484830a60"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::fPageSize" ref="abbcb8b2461229b0e3c3d12b484830a60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#abbcb8b2461229b0e3c3d12b484830a60">fPageSize</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00137">137</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e041ba43d06e19f13362db84cb2eac9"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::lfCapability" ref="a0e041ba43d06e19f13362db84cb2eac9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a0e041ba43d06e19f13362db84cb2eac9">lfCapability</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00140">140</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a2d4df151e5b0c94e87c699dac29bed44"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::lsbAddress" ref="a2d4df151e5b0c94e87c699dac29bed44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a2d4df151e5b0c94e87c699dac29bed44">lsbAddress</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00134">134</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00536">BlockLoad()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a58ca3b9b83727957c5e3d2395dd6db31"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::msbAddress" ref="a58ca3b9b83727957c5e3d2395dd6db31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a58ca3b9b83727957c5e3d2395dd6db31">msbAddress</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00135">135</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00611">BlockRead()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e37664306c255e1c9e97bcfcd3227ee"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::part" ref="a0e37664306c255e1c9e97bcfcd3227ee" args="[NUMPARTS][6]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#a0e37664306c255e1c9e97bcfcd3227ee">part</a>[NUMPARTS][6]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {

{   0x91,  0x09,   16,    0,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  0x77     },  
{   0x91,  0x0A,   16,    4,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   0xFF     },  
{   0x92,  0x05,   32,    4,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   0xFF     },  
{   0x93,  0x08,   32,    0,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  0x77     },  
{   0x93,  0x0A,   32,    4,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   0xFF     },  
{   0x94,  0x03,   64,    4,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   0x77     },  
{   0x94,  0x06,   64,    4,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   0xFF     },  
{   0x95,  0x02,   64,    0,   <a class="code" href="serial-programmer-at90s2313_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  0x77     }   
}
</pre></div>
<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00118">118</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ac7c4860b47674f6bb351f6875e50533f"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::received" ref="ac7c4860b47674f6bb351f6875e50533f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-at90s2313_8c.html#ac7c4860b47674f6bb351f6875e50533f">received</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00141">141</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a937c9ea30a584c36e788de708fd56234"></a><!-- doxytag: member="serial&#45;programmer&#45;at90s2313.c::tempInt" ref="a937c9ea30a584c36e788de708fd56234" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="serial-programmer-at90s2313_8c.html#a937c9ea30a584c36e788de708fd56234">tempInt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00133">133</a> of file <a class="el" href="serial-programmer-at90s2313_8c_source.html">serial-programmer-at90s2313.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00143">main()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Apr 6 09:29:40 2010 for AVR Serial Programmer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
