<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AVR Serial Programmer: serial-programmer-test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>serial-programmer-test.c File Reference</h1><code>#include &lt;inttypes.h&gt;</code><br/>
<code>#include &lt;avr/sfr_defs.h&gt;</code><br/>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/wdt.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="defines_8h_source.html">defines.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="serial-programmer-at90s2313_8h_source.html">serial-programmer-at90s2313.h</a>&quot;</code><br/>
<code>#include &lt;util/delay.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="serial_8h_source.html">serial.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for serial-programmer-test.c:</div>
<div class="dynsection">
<div class="center"><img src="serial-programmer-test_8c__incl.png" border="0" usemap="#serial-programmer-test_8c_map" alt=""/></div>
<map name="serial-programmer-test_8c_map" id="serial-programmer-test_8c">
<area shape="rect" href="defines_8h.html" title="defines.h" alt="" coords="419,83,493,112"/><area shape="rect" href="serial-programmer-at90s2313_8h.html" title="serial&#45;programmer&#45;at90s2313.h" alt="" coords="517,83,715,112"/><area shape="rect" href="serial_8h.html" title="serial.h" alt="" coords="845,83,909,112"/></map>
</div>

<p><a href="serial-programmer-test_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a11643f271076024c395a93800b3d9546">_BV</a>(bit)&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a5f2f31448ae0df9a545e0ca95e748f16">inb</a>(sfr)&nbsp;&nbsp;&nbsp;_SFR_BYTE(sfr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ab5e5eb4fcc7a892227a005faab343610">inw</a>(sfr)&nbsp;&nbsp;&nbsp;_SFR_WORD(sfr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ab2639428f628a54f52f28ace148beb13">outb</a>(sfr, val)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) = (val))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#aaf663ae912dca7197d8ffab94ecbfb6d">outw</a>(sfr, val)&nbsp;&nbsp;&nbsp;(_SFR_WORD(sfr) = (val))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ae70baf5399951da1e7ad45a0ed890832">cbi</a>(sfr, bit)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) &amp;= ~_BV(bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ac4a5536d9bf092116f88b94797ddc882">sbi</a>(sfr, bit)&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) |= _BV(bit))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a292660d4f9b4776e3ae19a977c2c9d51">high</a>(x)&nbsp;&nbsp;&nbsp;((uint8_t) (x &gt;&gt; 8) &amp; 0xFF)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ae7272abbc457b8a5fd4de78326f216a3">low</a>(x)&nbsp;&nbsp;&nbsp;((uint8_t) (x &amp; 0xFF))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a67cdcb125cf91919881351114f5b6cbd">APP_END</a>&nbsp;&nbsp;&nbsp;0x2000</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#aa4f00419077779c9de129f2f9bd1f3bf">BlockLoad</a> (uint16_t size, unsigned char mem, uint16_t *<a class="el" href="serial-programmer-test_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a block to application memory.  <a href="#aa4f00419077779c9de129f2f9bd1f3bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a6f87010d22630bd65b7953d190c55fb0">BlockRead</a> (unsigned int size, unsigned char mem, uint16_t *<a class="el" href="serial-programmer-test_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a block from application memory.  <a href="#a6f87010d22630bd65b7953d190c55fb0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#ad8a9ca95bd263ee8a63640e95bafd0ec">writeByte</a> (const uint8_t datum)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a Byte to the SPI.  <a href="#ad8a9ca95bd263ee8a63640e95bafd0ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a378eeebde3e3245f5eed58b91f2ccef8">writeCommand</a> (const uint8_t cmd, const uint8_t parm1, const uint8_t parm2, const uint8_t parm3)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a four byte Programming command to the SPI.  <a href="#a378eeebde3e3245f5eed58b91f2ccef8"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Serial Programmer Main Program.  <a href="#a643d30df67a67c5915fde941c934f9f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#af48e0311746bc01574a90f142220e748">command</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a556c80259568976b607ec50f8747d42a">result</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a1ba5d286a5955d82dbd75197ed701913">tempInt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a2d4df151e5b0c94e87c699dac29bed44">lsbAddress</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a58ca3b9b83727957c5e3d2395dd6db31">msbAddress</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial-programmer-test_8c.html#a59bb6204e17a27f285f9b7cedac9367d">buffer</a> [4]</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a11643f271076024c395a93800b3d9546"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::_BV" ref="a11643f271076024c395a93800b3d9546" args="(bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _BV</td>
          <td>(</td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00056">56</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a67cdcb125cf91919881351114f5b6cbd"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::APP_END" ref="a67cdcb125cf91919881351114f5b6cbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APP_END&nbsp;&nbsp;&nbsp;0x2000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00066">66</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-test_8c_source.html#l00082">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ae70baf5399951da1e7ad45a0ed890832"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::cbi" ref="ae70baf5399951da1e7ad45a0ed890832" args="(sfr, bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cbi</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) &amp;= ~_BV(bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00061">61</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa93f0eb578d23995850d61f7d61c55c1"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::FALSE" ref="aa93f0eb578d23995850d61f7d61c55c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FALSE&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00054">54</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a292660d4f9b4776e3ae19a977c2c9d51"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::high" ref="a292660d4f9b4776e3ae19a977c2c9d51" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define high</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((uint8_t) (x &gt;&gt; 8) &amp; 0xFF)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00063">63</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5f2f31448ae0df9a545e0ca95e748f16"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::inb" ref="a5f2f31448ae0df9a545e0ca95e748f16" args="(sfr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define inb</td>
          <td>(</td>
          <td class="paramtype">sfr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;_SFR_BYTE(sfr)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00057">57</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab5e5eb4fcc7a892227a005faab343610"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::inw" ref="ab5e5eb4fcc7a892227a005faab343610" args="(sfr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define inw</td>
          <td>(</td>
          <td class="paramtype">sfr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;_SFR_WORD(sfr)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00058">58</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae7272abbc457b8a5fd4de78326f216a3"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::low" ref="ae7272abbc457b8a5fd4de78326f216a3" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define low</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((uint8_t) (x &amp; 0xFF))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00064">64</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab2639428f628a54f52f28ace148beb13"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::outb" ref="ab2639428f628a54f52f28ace148beb13" args="(sfr, val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define outb</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) = (val))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00059">59</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaf663ae912dca7197d8ffab94ecbfb6d"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::outw" ref="aaf663ae912dca7197d8ffab94ecbfb6d" args="(sfr, val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define outw</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">val&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_WORD(sfr) = (val))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00060">60</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac4a5536d9bf092116f88b94797ddc882"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::sbi" ref="ac4a5536d9bf092116f88b94797ddc882" args="(sfr, bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define sbi</td>
          <td>(</td>
          <td class="paramtype">sfr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(_SFR_BYTE(sfr) |= _BV(bit))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00062">62</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa8cecfc5c5c054d2875c03e77b7be15d"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::TRUE" ref="aa8cecfc5c5c054d2875c03e77b7be15d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRUE&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00053">53</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa4f00419077779c9de129f2f9bd1f3bf"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::BlockLoad" ref="aa4f00419077779c9de129f2f9bd1f3bf" args="(uint16_t size, unsigned char mem, uint16_t *address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char BlockLoad </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&nbsp;</td>
          <td class="paramname"> <em>address</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a block to application memory. </p>
<p>The block is firstly written to a temporary buffer to cope with a fast serial communication, then it is written page by page to the AVR internal page buffer, each page followed by a page write. The program allows for blocksizes larger than the internal page buffer, but due to the AT90S2313 SRAM restrictions, it cannot be more than about 64 bytes. The EEPROM internal buffer is typically only 4 bytes, while the FLASH buffer is normally 64. Take care that EEPROM addresses are given in bytes, while FLASH addresses are in words.</p>
<p>We may change this later to not use the block load in either memory type. Due to pagesize variations it is difficult to make this general. </p>

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00356">356</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00023">EPAGESIZE</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00021">FPAGESIZE</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00129">lsbAddress</a>, <a class="el" href="serial_8c_source.html#l00038">recchar()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00672">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f87010d22630bd65b7953d190c55fb0"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::BlockRead" ref="a6f87010d22630bd65b7953d190c55fb0" args="(unsigned int size, unsigned char mem, uint16_t *address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char BlockRead </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&nbsp;</td>
          <td class="paramname"> <em>address</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a block from application memory. </p>
<p>There is no block read as such in the SPI interface, just do it byte by byte. Take care that EEPROM addresses are given in bytes, while FLASH addresses are in words. Returns a character representing a status. The block represented by the address is filled with data from memory. </p>

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00436">436</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00090">high</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00091">low</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00129">lsbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00130">msbAddress</a>, <a class="el" href="serial_8c_source.html#l00030">sendchar()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00672">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::main" ref="a840291bc02cba5474a4cb46a9b9566fe" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00082">82</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00126">address</a>, <a class="el" href="serial-programmer-test_8c_source.html#l00066">APP_END</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">buffer</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00088">cbi</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00127">command</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00090">high</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00084">inb</a>, <a class="el" href="serial_8c_source.html#l00022">initbootuart()</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00091">low</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00129">lsbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00130">msbAddress</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00086">outb</a>, <a class="el" href="serial_8c_source.html#l00038">recchar()</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00029">RESET</a>, <a class="el" href="serial-programmer-test_8c_source.html#l00076">result</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00089">sbi</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00026">SCK</a>, <a class="el" href="serial_8c_source.html#l00030">sendchar()</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00672">writeCommand()</a>.</p>

</div>
</div>
<a class="anchor" id="ad8a9ca95bd263ee8a63640e95bafd0ec"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::writeByte" ref="ad8a9ca95bd263ee8a63640e95bafd0ec" args="(const uint8_t datum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t writeByte </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>datum</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a Byte to the SPI. </p>
<p>Issue a write of a single byte on the SPI interface Note that the data is transmitted and received MSB first. Also note that the device is acting as a Master for the SPI bus,so MOSI is output and MISO is input.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>datum,:</em>&nbsp;</td><td>the byte to be written </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>response: a byte read at the same time as the byte was written. </dd></dl>

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00486">486</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00083">_BV</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00088">cbi</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00084">inb</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00027">MISO</a>, <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00028">MOSI</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00086">outb</a>, <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00089">sbi</a>, and <a class="el" href="serial-programmer-at90s2313_8h_source.html#l00026">SCK</a>.</p>

</div>
</div>
<a class="anchor" id="a378eeebde3e3245f5eed58b91f2ccef8"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::writeCommand" ref="a378eeebde3e3245f5eed58b91f2ccef8" args="(const uint8_t cmd, const uint8_t parm1, const uint8_t parm2, const uint8_t parm3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeCommand </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>parm3</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a four byte Programming command to the SPI. </p>
<p>Issue a write command on the SPI interface This returns responses which (usually) match the command, one byte delayed. The third byte read from the "start programming" command can be used to verify sync. Other read commands return the read value in the fourth byte.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Four</em>&nbsp;</td><td>bytes of the SPI Programming command </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The global buffer four bytes with the data returned from the command </dd></dl>

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00516">516</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>References <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00131">buffer</a>, and <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00639">writeByte()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a643d30df67a67c5915fde941c934f9f8"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::address" ref="a643d30df67a67c5915fde941c934f9f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="serial-programmer-test_8c.html#a643d30df67a67c5915fde941c934f9f8">address</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Serial Programmer Main Program. </p>
<p>This receives a command and interprets it according to the AVRPROG interface. </p>

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00074">74</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a59bb6204e17a27f285f9b7cedac9367d"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::buffer" ref="a59bb6204e17a27f285f9b7cedac9367d" args="[4]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-test_8c.html#a59bb6204e17a27f285f9b7cedac9367d">buffer</a>[4]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00080">80</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="af48e0311746bc01574a90f142220e748"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::command" ref="af48e0311746bc01574a90f142220e748" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="serial-programmer-test_8c.html#af48e0311746bc01574a90f142220e748">command</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00075">75</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2d4df151e5b0c94e87c699dac29bed44"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::lsbAddress" ref="a2d4df151e5b0c94e87c699dac29bed44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-test_8c.html#a2d4df151e5b0c94e87c699dac29bed44">lsbAddress</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00078">78</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a58ca3b9b83727957c5e3d2395dd6db31"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::msbAddress" ref="a58ca3b9b83727957c5e3d2395dd6db31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-test_8c.html#a58ca3b9b83727957c5e3d2395dd6db31">msbAddress</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00079">79</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
<a class="anchor" id="a556c80259568976b607ec50f8747d42a"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::result" ref="a556c80259568976b607ec50f8747d42a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-test_8c.html#a556c80259568976b607ec50f8747d42a">result</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00076">76</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

<p>Referenced by <a class="el" href="serial-programmer-at90s2313_8c_source.html#l00138">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ba5d286a5955d82dbd75197ed701913"></a><!-- doxytag: member="serial&#45;programmer&#45;test.c::tempInt" ref="a1ba5d286a5955d82dbd75197ed701913" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="serial-programmer-test_8c.html#a1ba5d286a5955d82dbd75197ed701913">tempInt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serial-programmer-test_8c_source.html#l00077">77</a> of file <a class="el" href="serial-programmer-test_8c_source.html">serial-programmer-test.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Fri Apr 2 17:07:17 2010 for AVR Serial Programmer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
